{"ast":null,"code":"import { Dispatcher } from '../dispatcher/dispatcher.js';\nimport { BridgeEvents } from './types.js';\nconst BRIDGE_MESSAGE_TYPE_SDK = 'vk-sak-sdk';\nclass Bridge extends Dispatcher {\n  config;\n  constructor(config) {\n    super();\n    this.config = config;\n    this.handleMessage = this.handleMessage.bind(this);\n    // eslint-disable-next-line\n    window.addEventListener('message', this.handleMessage);\n  }\n  destroy() {\n    /* Clear references for memory */ // @ts-ignore-next-line Удаление происходит при десктруктуризации бриджа, поэтому это безопасно.\n    delete this.config;\n    // eslint-disable-next-line\n    window.removeEventListener('message', this.handleMessage);\n  }\n  sendMessage(message) {\n    this.config.iframe.contentWindow?.postMessage({\n      type: BRIDGE_MESSAGE_TYPE_SDK,\n      ...message\n    }, this.config.origin);\n  }\n  handleMessage(event) {\n    const isUnsupportedMessage = !this.config.origin || event.origin !== this.config.origin || event.source !== this.config.iframe.contentWindow || event.data?.type !== BRIDGE_MESSAGE_TYPE_SDK;\n    if (isUnsupportedMessage) {\n      this.events.emit(BridgeEvents.UNSUPPORTED_MESSAGE, event.data);\n      return;\n    }\n    this.events.emit(BridgeEvents.MESSAGE, event.data);\n  }\n}\nexport { BRIDGE_MESSAGE_TYPE_SDK, Bridge };","map":{"version":3,"names":["Dispatcher","BridgeEvents","BRIDGE_MESSAGE_TYPE_SDK","Bridge","config","constructor","handleMessage","bind","window","addEventListener","destroy","removeEventListener","sendMessage","message","iframe","contentWindow","postMessage","type","origin","event","isUnsupportedMessage","source","data","events","emit","UNSUPPORTED_MESSAGE","MESSAGE"],"sources":["C:/Users/player/Documents/GitHub/synask-app/node_modules/@vkid/sdk/dist-sdk/esm/core/bridge/bridge.js"],"sourcesContent":["import { Dispatcher } from '../dispatcher/dispatcher.js';\nimport { BridgeEvents } from './types.js';\n\nconst BRIDGE_MESSAGE_TYPE_SDK = 'vk-sak-sdk';\nclass Bridge extends Dispatcher {\n    config;\n    constructor(config){\n        super();\n        this.config = config;\n        this.handleMessage = this.handleMessage.bind(this);\n        // eslint-disable-next-line\n        window.addEventListener('message', this.handleMessage);\n    }\n    destroy() {\n        /* Clear references for memory */ // @ts-ignore-next-line Удаление происходит при десктруктуризации бриджа, поэтому это безопасно.\n        delete this.config;\n        // eslint-disable-next-line\n        window.removeEventListener('message', this.handleMessage);\n    }\n    sendMessage(message) {\n        this.config.iframe.contentWindow?.postMessage({\n            type: BRIDGE_MESSAGE_TYPE_SDK,\n            ...message\n        }, this.config.origin);\n    }\n    handleMessage(event) {\n        const isUnsupportedMessage = !this.config.origin || event.origin !== this.config.origin || event.source !== this.config.iframe.contentWindow || event.data?.type !== BRIDGE_MESSAGE_TYPE_SDK;\n        if (isUnsupportedMessage) {\n            this.events.emit(BridgeEvents.UNSUPPORTED_MESSAGE, event.data);\n            return;\n        }\n        this.events.emit(BridgeEvents.MESSAGE, event.data);\n    }\n}\n\nexport { BRIDGE_MESSAGE_TYPE_SDK, Bridge };\n"],"mappings":"AAAA,SAASA,UAAU,QAAQ,6BAA6B;AACxD,SAASC,YAAY,QAAQ,YAAY;AAEzC,MAAMC,uBAAuB,GAAG,YAAY;AAC5C,MAAMC,MAAM,SAASH,UAAU,CAAC;EAC5BI,MAAM;EACNC,WAAWA,CAACD,MAAM,EAAC;IACf,KAAK,CAAC,CAAC;IACP,IAAI,CAACA,MAAM,GAAGA,MAAM;IACpB,IAAI,CAACE,aAAa,GAAG,IAAI,CAACA,aAAa,CAACC,IAAI,CAAC,IAAI,CAAC;IAClD;IACAC,MAAM,CAACC,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAACH,aAAa,CAAC;EAC1D;EACAI,OAAOA,CAAA,EAAG;IACN,kCAAkC;IAClC,OAAO,IAAI,CAACN,MAAM;IAClB;IACAI,MAAM,CAACG,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAACL,aAAa,CAAC;EAC7D;EACAM,WAAWA,CAACC,OAAO,EAAE;IACjB,IAAI,CAACT,MAAM,CAACU,MAAM,CAACC,aAAa,EAAEC,WAAW,CAAC;MAC1CC,IAAI,EAAEf,uBAAuB;MAC7B,GAAGW;IACP,CAAC,EAAE,IAAI,CAACT,MAAM,CAACc,MAAM,CAAC;EAC1B;EACAZ,aAAaA,CAACa,KAAK,EAAE;IACjB,MAAMC,oBAAoB,GAAG,CAAC,IAAI,CAAChB,MAAM,CAACc,MAAM,IAAIC,KAAK,CAACD,MAAM,KAAK,IAAI,CAACd,MAAM,CAACc,MAAM,IAAIC,KAAK,CAACE,MAAM,KAAK,IAAI,CAACjB,MAAM,CAACU,MAAM,CAACC,aAAa,IAAII,KAAK,CAACG,IAAI,EAAEL,IAAI,KAAKf,uBAAuB;IAC5L,IAAIkB,oBAAoB,EAAE;MACtB,IAAI,CAACG,MAAM,CAACC,IAAI,CAACvB,YAAY,CAACwB,mBAAmB,EAAEN,KAAK,CAACG,IAAI,CAAC;MAC9D;IACJ;IACA,IAAI,CAACC,MAAM,CAACC,IAAI,CAACvB,YAAY,CAACyB,OAAO,EAAEP,KAAK,CAACG,IAAI,CAAC;EACtD;AACJ;AAEA,SAASpB,uBAAuB,EAAEC,MAAM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}